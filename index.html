<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Modern Hayatta Hayatta Kalma Kılavuzu — Retro Mizah</title>
  <style>
    :root{--bg:#f0f2f5;--ink:#222;--link:#0033cc;--visited:#660099;--frame:#c9d2df;--nav:#e6ecf3;--accent:#ffcc00}
    html,body{margin:0;padding:0;background:var(--bg) url('https://www.transparenttextures.com/patterns/subtle-dots.png');color:var(--ink);font:15px/1.5 Verdana,Tahoma,sans-serif}
    a{color:var(--link);text-decoration:underline;cursor:pointer}
    a:visited{color:var(--visited)}
    .wrap{max-width:960px;margin:12px auto;padding:6px;border:3px ridge var(--frame);background:#fff;box-shadow:0 0 0 4px #fff,0 0 0 7px var(--frame)}
    header{border-bottom:3px ridge var(--frame);padding:10px;background:linear-gradient(#fff,#f7fbff);display:flex;align-items:center;gap:10px;flex-wrap:nowrap}
    .badge{background:var(--accent);border:3px outset #d4a800;padding:6px 10px;font-weight:bold;white-space:nowrap}
    h1{font-size:20px;margin:0;color:#003366;text-shadow:1px 1px 0 #fff}
    nav{display:flex;gap:6px;flex-wrap:wrap;padding:8px;background:var(--nav);border-bottom:3px groove var(--frame)}
    .btn{padding:6px 10px;border:2px outset #b9c7d8;background:#fff;cursor:pointer;font-weight:bold;white-space:nowrap}
    .btn:active{border-style:inset}
    .grid{display:grid;grid-template-columns:220px 1fr;gap:12px;padding:12px}
    aside{border:3px ridge var(--frame);padding:8px;background:#f9fbfe}
    main{border:3px ridge var(--frame);padding:16px;min-height:420px;background:#fff}
    .section{display:none}
    .section.active{display:block}
    .blink{animation:blink 1.2s steps(2,end) infinite;color:#c00;font-weight:bold}
    @keyframes blink{50%{opacity:0}}
    footer{padding:10px;border-top:3px ridge var(--frame);background:#f7fbff;font-size:12px;color:#555;text-align:center}
    marquee{color:#003366;background:var(--accent);padding:4px;font-weight:bold;border-top:2px solid #d4a800;border-bottom:2px solid #d4a800}
    .links{margin:0;padding:0;list-style:none}
    .links li{border-bottom:1px dashed #b9c7d8;padding:6px 0}
    .links a{font-weight:bold;text-decoration:none;color:var(--link)}
    .detail{display:none;margin:6px 0 12px 0;padding:8px;border:2px inset #c9d2df;background:#f9fbfe}
    /* Mobil */
    @media(max-width:820px){
      .grid{grid-template-columns:1fr}
      header{flex-direction:row;align-items:center}
      .badge{font-size:14px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="badge">★ RETRO ★</div>
      <h1>Modern Hayatta Hayatta Kalma Kılavuzu</h1>
    </header>

    <marquee behavior="scroll" direction="left">✨ Hoş geldiniz! Retro hissi burada. Ziyaretçi sayacı ve misafir defteri eklendi! ✨</marquee>

    <nav>
      <a href="#kilavuz" class="btn">Kılavuz</a>
      <a href="#modern-analiz" class="btn">Modern Çağ Analizleri</a>
      <a href="#kendilerini-ne" class="btn">Kendilerini Ne Zannediyorlar?</a>
      <a href="#meslek" class="btn">Meslek Deformasyonları</a>
      <a href="#hakkinda" class="btn">Hakkında</a>
    </nav>

    <div class="grid">
      <aside>
        <b>📌 Çok Yakında</b>
        <div class="blink">YENİ!</div>
        <ul>
          <li>Modern Çağ Analizleri</li>
          <li>Kendilerini Ne Zannediyorlar?</li>
          <li>Meslek Deformasyonları</li>
        </ul>
        <p style="margin:8px 0">Hit sayacı: <span id="counter" class="counter" style="font-family:monospace;background:#000;color:#0f0;padding:2px 6px;display:inline-block">000000</span></p>
        <p><img src="https://www.animatedimages.org/data/media/56/animated-under-construction-image-0022.gif" width="100" alt="retro under construction"></p>
      </aside>

      <main>
        <section id=\"kilavuz\" class=\"section active\">
          <h2>🧭 Kılavuz: Hayatta Kalma İçin Mizahi Çözümler</h2>
          <p><b>Dertler listesi:</b> Her maddeye tıkla, detaylar açılsın.</p>
          <ul class=\"links\">
            <li><a onclick=\"toggleDetail('d-kahve')\">Kahve Bağımlılığı</a></li>
            <li><a onclick=\"toggleDetail('d-toplanti')\">Toplantı Maratonları</a></li>
            <li><a onclick=\"toggleDetail('d-internet')\">İnternetsiz Kalma</a></li>
            <li><a onclick=\"toggleDetail('d-diyet')\">Diyet Başarısızlıkları</a></li>
            <li><a onclick=\"toggleDetail('d-goruldu')\">Mesaj Görüldü</a></li>
          </ul>

          <div class=\"detail\" style=\"display:block;background:#fff;border:none;padding:0;margin:10px 0\">
            <h3>📜 Önsöz</h3>
            <p>Sevgili Okur, bu kılavuz tam da “vay arkadaş hakikaten he, benim de başıma gelmişti” dedirten dertlere mizahi reçeteler sunar. Modern dünya hepimizi kutu gibi evlerde, kalabalık caddelerde kulaklıkla yalnız bıraktı. Ama işte bu kılavuz, “ulan bunu da çözdük ya” dedirten çözümlerle yalnız olmadığımızı hatırlatacak. Dertlerimizi tek başımıza değil, topluca tiye alacağız. Çünkü mizah, modern çağın en güçlü hayatta kalma yöntemidir.</p>
          </div>

          <div id=\"d-kahve\" class=\"detail\">Sabah kahvesini içmeden kimseyle konuşma; gerekirse “Lütfen kahveden sonra konuşun” kartı taşı.</div>
          <div id=\"d-toplanti\" class=\"detail\">Toplantılar hiç bitmiyorsa ekranını dondur; donmuş surat en iyi kaçış yöntemidir.</div>
          <div id=\"d-internet\" class=\"detail\">Modem ışığı sönünce hemen komşuya git ve “Şifre neydi?” diye sor; sosyal ilişkiler gelişir.</div>
          <div id=\"d-diyet\" class=\"detail\">Spor salonuna yazılıp hiç gitmemek yerine, telefonunda “Spor” klasörü aç; psikolojik olarak motive edici.</div>
          <div id=\"d-goruldu\" class=\"detail\">Cevap yazmaya üşeniyorsan emoji spamı at; karşı taraf anlam yükleyip seni düşünmekle meşgul olur.</div>
        </section>
        </section>

        <section id="modern-analiz" class="section">
          <h2>📊 Modern Çağ Analizleri</h2>
          <p>Çok yakında yayında!</p>
        </section>

        <section id="kendilerini-ne" class="section">
          <h2>🧩 Kendilerini Ne Zannediyorlar?</h2>
          <p>Çok yakında yayında!</p>
        </section>

        <section id="meslek" class="section">
          <h2>💼 Meslek Deformasyonları</h2>
          <p>Çok yakında yayında!</p>
        </section>

        <section id="hakkinda" class="section">
          <h2>ℹ️ Hakkında</h2>
          <p>Bu site mizah odaklı, <span class="blink">retro</span> bir tasarımla modern hayatın absürtlüklerine eğlenceli çözümler sunar. Web 1.0 hissi için marquee, gif ve klasik çerçeve stilleri kullanılır.</p>
          <h3>💬 Misafir Defteri (Yerel)</h3>
          <form id="guestForm" style="border:2px outset #b9c7d8;padding:8px;background:#f7fbff">
            <label>İsim: <input type="text" id="guestName" required maxlength="40"></label>
            <br/>
            <label>Mesaj: <input type="text" id="guestMsg" required maxlength="200" style="width:90%"></label>
            <br/>
            <button type="submit" class="btn">Gönder</button>
          </form>
          <ul id="guestList" style="list-style: none; padding-left: 0; margin-top:10px"></ul>
          <p style="font-size:12px;color:#666">Not: Bu misafir defteri şu an tarayıcında saklanır (yerel). Yalnızca bu cihazda görünür, istersen silebilirsin.</p>

          <h3>🌐 Herkese Açık Yorumlar (Üyelik ile)</h3>
          <p style="margin-top:4px">Kullanıcı adı (görünen ad) ve e‑posta/parola ile giriş yapıp yorum bırakabilirsin. <b>Silme yetkisi yalnızca admin’dedir.</b></p>

          <div id="authBox" style="border:2px outset #b9c7d8;padding:8px;background:#fff;margin-bottom:10px">
            <div id="whenSignedOut">
              <input type="text" id="regName" placeholder="Görünen ad" maxlength="40"/>
              <input type="email" id="regEmail" placeholder="E‑posta"/>
              <input type="password" id="regPass" placeholder="Parola"/>
              <button class="btn" id="btnRegister">Kayıt Ol</button>
              <span style="margin:0 6px">ya da</span>
              <input type="email" id="logEmail" placeholder="E‑posta"/>
              <input type="password" id="logPass" placeholder="Parola"/>
              <button class="btn" id="btnLogin">Giriş Yap</button>
            </div>
            <div id="whenSignedIn" style="display:none">
              Merhaba, <b id="userName"></b> — <button class="btn" id="btnLogout">Çıkış</button>
            </div>
          </div>

          <form id="fbForm" style="border:2px outset #b9c7d8;padding:8px;background:#f7fbff;display:none">
            <input type="text" id="fbName" placeholder="Görünen ad" maxlength="40" style="width:200px"/>
            <input type="text" id="fbMsg" placeholder="Mesaj" required maxlength="240" style="width:60%"/>
            <button type="submit" class="btn">Yayınla</button>
          </form>
          <div id="fbList" style="margin-top:10px"></div>
        </section>
      </main>
    </div>

    <footer>
      © <span id="y"></span> Retro Mizah | Çok Yakında Daha Fazla İçerik!
    </footer>
  </div>

  <script>
    function showSection(hash){
      const id = (hash || location.hash || '#kilavuz');
      document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
      const el=document.querySelector(id);
      if(el){el.classList.add('active');}
    }
    window.addEventListener('hashchange',()=>showSection(location.hash));
    showSection();
    document.getElementById('y').textContent = new Date().getFullYear();

    // Basit ziyaretçi sayacı
    (function(){
      try{
        const key = 'hits_'+location.host;
        const n = parseInt(localStorage.getItem(key)||'0',10)+1;
        localStorage.setItem(key,String(n));
        const c = document.getElementById('counter');
        if(c){ c.textContent = (''+n).padStart(6,'0'); }
      }catch(e){}
    })();

    // Misafir Defteri
    (function(){
      const listEl = document.getElementById('guestList');
      const form = document.getElementById('guestForm');
      const key = 'guestbook_'+location.host;
      const esc = s => s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[m]));
      function load(){
        const arr = JSON.parse(localStorage.getItem(key)||'[]');
        listEl.innerHTML = '';
        arr.forEach(item => {
          const li = document.createElement('li');
          li.style.border = '2px inset #c9d2df';
          li.style.background = '#fff';
          li.style.padding = '6px';
          li.style.margin = '6px 0';
          li.innerHTML = '<b>'+esc(item.name)+'</b>: '+esc(item.msg)+' <span style="color:#999;font-size:12px">('+new Date(item.ts).toLocaleString()+')</span>'+
                         ' <button data-id="'+item.id+'" class="btn" style="padding:2px 6px">Sil</button>';
          listEl.appendChild(li);
        });
      }
      function save(arr){ localStorage.setItem(key, JSON.stringify(arr)); }
      form.addEventListener('submit', e=>{
        e.preventDefault();
        const name = document.getElementById('guestName').value.trim();
        const msg  = document.getElementById('guestMsg').value.trim();
        if(!name||!msg) return;
        const arr = JSON.parse(localStorage.getItem(key)||'[]');
        arr.unshift({id:Date.now()+Math.random().toString(16).slice(2), name, msg, ts:Date.now()});
        save(arr); load(); form.reset();
      });
      listEl.addEventListener('click', e=>{
        const id = e.target && e.target.getAttribute('data-id');
        if(!id) return;
        const arr = JSON.parse(localStorage.getItem(key)||'[]').filter(x=>x.id!==id);
        save(arr); load();
      });
      load();
    })();

    // Dert detaylarını aç/kapat
    function toggleDetail(id){
      const el = document.getElementById(id);
      if(!el) return;
      el.style.display = (el.style.display==='block')? 'none':'block';
    }
    // === Kamu Yorumları (API tabanlı) ===
    const API_URL = 'https://YOUR_WORKER_SUBDOMAIN.workers.dev/comments'; // ← Cloudflare Worker adresinle değiştir
    async function fetchComments(){
      try{
        const r = await fetch(API_URL, {headers:{'Accept':'application/json'}});
        const data = await r.json();
        renderComments(Array.isArray(data)?data:[]);
      }catch(e){ console.warn('Yorumlar alınamadı', e); }
    }
    function renderComments(items){
      const box = document.getElementById('publicList');
      box.innerHTML = '';
      if(!items.length){ box.innerHTML = '<p>Henüz yorum yok.</p>'; return; }
      items.sort((a,b)=>b.ts-a.ts);
      items.forEach(it=>{
        const div = document.createElement('div');
        div.style.border='2px inset #c9d2df';div.style.background='#f9fbfe';div.style.padding='8px';div.style.margin='8px 0';
        const safe = s=>String(s).replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[m]));
        div.innerHTML = `<b>${safe(it.name)}</b>: ${safe(it.msg)} <span style="color:#999;font-size:12px">(${new Date(it.ts).toLocaleString()})</span>
          <button class="btn" style="padding:2px 6px;float:right" data-del="${it.id}">Sil</button>`;
        box.appendChild(div);
      });
    }
    document.getElementById('publicForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const name = document.getElementById('pName').value.trim();
      const msg  = document.getElementById('pMsg').value.trim();
      const hp   = document.getElementById('pHp').value.trim();
      if(hp) return; // bot
      if(!name||!msg) return;
      try{
        await fetch(API_URL, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({name, msg})});
        document.getElementById('pName').value=''; document.getElementById('pMsg').value='';
        fetchComments();
      }catch(e){ alert('Gönderilemedi'); }
    });
    document.getElementById('publicList').addEventListener('click', async (e)=>{
      const id = e.target && e.target.getAttribute('data-del');
      if(!id) return;
      const key = prompt('Admin anahtarı:');
      if(!key) return;
      try{
        await fetch(API_URL+'/'+encodeURIComponent(id), {method:'DELETE', headers:{'Authorization':'Bearer '+key}});
        fetchComments();
      }catch(err){ alert('Silme başarısız'); }
    });
    fetchComments();

  </script>
  <!-- Firebase (CDN) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script>
    // === Firebase Config — kendi projenle değiştir ===
    const firebaseConfig = {
  apiKey: "AIzaSyAvswnxF_LPQvay7CUXsg_dfzdRrlE4cP0",
  authDomain: "mizahtanvareste-9e328.firebaseapp.com",
  projectId: "mizahtanvareste-9e328",
  storageBucket: "mizahtanvareste-9e328.firebasestorage.app",
  messagingSenderId: "1094184156880",
  appId: "1:1094184156880:web:d14b5a80627ee08ebaa8d5"
};
    const ADMIN_UID = 'FDmTVoV1sMashImDa8hLkNWVK7k2'; // Admin olarak belirlediğin hesabın UID'i

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db   = firebase.firestore();

    // UI elemanları
    const whenIn  = document.getElementById('whenSignedIn');
    const whenOut = document.getElementById('whenSignedOut');
    const userName= document.getElementById('userName');
    const fbForm  = document.getElementById('fbForm');
    const fbName  = document.getElementById('fbName');
    const fbMsg   = document.getElementById('fbMsg');
    const fbList  = document.getElementById('fbList');

    // Kayıt
    document.getElementById('btnRegister')?.addEventListener('click', async ()=>{
      const name = (document.getElementById('regName').value||'').trim();
      const email= (document.getElementById('regEmail').value||'').trim();
      const pass = (document.getElementById('regPass').value||'').trim();
      if(!name||!email||!pass) return alert('Lütfen ad/e‑posta/parola girin');
      const { user } = await auth.createUserWithEmailAndPassword(email, pass);
      await user.updateProfile({ displayName: name });
      alert('Kayıt başarılı, hoş geldin!');
    });

    // Giriş
    document.getElementById('btnLogin')?.addEventListener('click', async ()=>{
      const email= (document.getElementById('logEmail').value||'').trim();
      const pass = (document.getElementById('logPass').value||'').trim();
      if(!email||!pass) return alert('Lütfen e‑posta/parola girin');
      await auth.signInWithEmailAndPassword(email, pass);
    });

    // Çıkış
    document.getElementById('btnLogout')?.addEventListener('click', ()=> auth.signOut());

    // Auth durumunu izle
    auth.onAuthStateChanged(async (user)=>{
      if(user){
        whenIn.style.display='block';
        whenOut.style.display='none';
        userName.textContent = user.displayName || user.email;
        fbForm.style.display='block';
        fbName.value = user.displayName || '';
      }else{
        whenIn.style.display='none';
        whenOut.style.display='block';
        fbForm.style.display='none';
      }
    });

    // Yorum gönder
    fbForm?.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const user = auth.currentUser; if(!user) return alert('Lütfen giriş yapın');
      const name = (fbName.value||user.displayName||'Misafir').toString().slice(0,40);
      const msg  = (fbMsg.value||'').toString().slice(0,240).trim();
      if(!msg) return;
      await db.collection('comments').add({
        uid: user.uid,
        name,
        msg,
        ts: firebase.firestore.FieldValue.serverTimestamp()
      });
      fbMsg.value='';
    });

    // Listele & admin silme
    db.collection('comments').orderBy('ts','desc').onSnapshot((snap)=>{
      const safe = s=>String(s||'').replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[m]));
      fbList.innerHTML='';
      snap.forEach(doc=>{
        const d = doc.data();
        const div = document.createElement('div');
        div.style.border='2px inset #c9d2df';div.style.background='#f9fbfe';div.style.padding='8px';div.style.margin='8px 0';
        const dateStr = d.ts?.toDate ? d.ts.toDate().toLocaleString() : '';
        div.innerHTML = `<b>${safe(d.name)}</b>: ${safe(d.msg)} <span style="color:#999;font-size:12px">(${dateStr})</span>`;
        // Sadece admin'e silme butonu
        if(auth.currentUser && auth.currentUser.uid === ADMIN_UID){
          const btn = document.createElement('button');
          btn.className='btn'; btn.style.padding='2px 6px'; btn.style.float='right'; btn.textContent='Sil';
          btn.addEventListener('click', ()=> db.collection('comments').doc(doc.id).delete());
          div.appendChild(btn);
        }
        fbList.appendChild(div);
      });
    });
  </script>
</body>
</html>
